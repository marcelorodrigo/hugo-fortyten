{{- /* Get parameters - support both positional and named syntax */ -}}
{{- $src := .Get 0 | default (.Get "src") -}}
{{- $width := .Get "width" -}}
{{- if not $width -}}
  {{- $width = .Get 1 | default "800" -}}
{{- end -}}
{{- $height := .Get "height" -}}
{{- if not $height -}}
  {{- $height = .Get 2 | default "600" -}}
{{- end -}}
{{- $title := .Get "title" -}}
{{- $ariaLabel := .Get "aria-label" -}}
{{- $responsive := .Get "responsive" -}}

{{- /* Validate that we have a src */ -}}
{{- if not $src -}}
  {{- errorf "iframe shortcode requires a src URL. Usage: {{< iframe \"https://example.com\" >}} or {{< iframe src=\"https://example.com\" width=\"800\" height=\"600\" title=\"Description\" >}}" -}}
{{- end -}}

{{- /* Check if using named parameters (has "src" param explicitly) */ -}}
{{- $isNamed := .Get "src" -}}

{{- /* For named parameters, require title or aria-label for accessibility */ -}}
{{- if and $isNamed (and (not $title) (not $ariaLabel)) -}}
  {{- errorf "iframe shortcode with named parameters requires either a 'title' or 'aria-label' attribute for accessibility. Usage: {{< iframe src=\"https://example.com\" title=\"Description\" >}}" -}}
{{- end -}}

{{- /* Render the iframe with responsive support */ -}}
{{- if eq $responsive "true" -}}
<div style="position: relative; width: 100%; padding-bottom: 56.25%;">
  <iframe 
    src="{{ $src }}" 
    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" 
    frameborder="0" 
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
    allowfullscreen
    {{ if $title }}title="{{ $title }}"{{ end }}
    {{ if $ariaLabel }}aria-label="{{ $ariaLabel }}"{{ end }}>
  </iframe>
</div>
{{- else -}}
<iframe 
  src="{{ $src }}" 
  width="{{ $width }}" 
  height="{{ $height }}" 
  frameborder="0" 
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
  allowfullscreen
  {{ if $title }}title="{{ $title }}"{{ end }}
  {{ if $ariaLabel }}aria-label="{{ $ariaLabel }}"{{ end }}></iframe>
{{- end -}}
